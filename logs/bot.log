2025-12-18 19:34:19,804 - aiogram.event - INFO - Update id=846056349 is not handled. Duration 17 ms by bot id=8459808785
2025-12-18 19:34:19,804 - aiogram.event - ERROR - Cause exception while process update id=846056349 by bot id=8459808785
TypeError: UserManager.get_or_create() missing 1 required positional argument: 'phone'
Traceback (most recent call last):
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
    )
    ^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\SS Sanjar\python\CityHelp_bot\midlewares\logging.py", line 26, in __call__
    response = await handler(event, data)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\SS Sanjar\python\CityHelp_bot\midlewares\auth.py", line 25, in __call__
    user = await manager.get_or_create(
                 ~~~~~~~~~~~~~~~~~~~~~^
        user_id=from_user.id,
        ^^^^^^^^^^^^^^^^^^^^^
        full_name=from_user.full_name,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
TypeError: UserManager.get_or_create() missing 1 required positional argument: 'phone'
2025-12-18 19:36:33,017 - aiogram.dispatcher - INFO - Polling stopped
2025-12-18 19:36:33,018 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected
2025-12-18 19:36:33,018 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8459808785)
2025-12-18 19:36:33,272 - aiogram.dispatcher - INFO - Polling stopped for bot @TG_Bot_5665bot id=8459808785 - 'TG_Bot_5665'
2025-12-18 19:36:37,316 - aiogram.event - INFO - Update id=846056350 is not handled. Duration 1 ms by bot id=8459808785
2025-12-18 19:36:37,317 - aiogram.event - ERROR - Cause exception while process update id=846056350 by bot id=8459808785
AttributeError: 'User' object has no attribute 'phone'
Traceback (most recent call last):
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
    )
    ^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\SS Sanjar\python\CityHelp_bot\midlewares\logging.py", line 26, in __call__
    response = await handler(event, data)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\SS Sanjar\python\CityHelp_bot\midlewares\auth.py", line 28, in __call__
    phone=from_user.phone,
          ^^^^^^^^^^^^^^^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\pydantic\main.py", line 991, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'User' object has no attribute 'phone'
2025-12-18 20:20:10,237 - aiogram.dispatcher - INFO - Polling stopped
2025-12-18 20:20:10,238 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected
2025-12-18 20:20:10,238 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8459808785)
2025-12-18 20:20:10,502 - aiogram.dispatcher - INFO - Polling stopped for bot @TG_Bot_5665bot id=8459808785 - 'TG_Bot_5665'
2025-12-18 20:26:03,629 - aiogram.event - INFO - Update id=846056351 is not handled. Duration 157 ms by bot id=8459808785
2025-12-18 20:26:03,630 - aiogram.event - ERROR - Cause exception while process update id=846056351 by bot id=8459808785
ConnectionDoesNotExistError: connection was closed in the middle of operation
Traceback (most recent call last):
  File "C:\Users\sanja\AppData\Local\Programs\Python\Python313\Lib\asyncio\windows_events.py", line 463, in finish_socket_func
    return ov.getresult()
           ~~~~~~~~~~~~^^
OSError: [WinError 64] ”казанное сетевое им€ более недоступно

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\sanja\AppData\Local\Programs\Python\Python313\Lib\asyncio\proactor_events.py", line 286, in _loop_reading
    length = fut.result()
  File "C:\Users\sanja\AppData\Local\Programs\Python\Python313\Lib\asyncio\windows_events.py", line 804, in _poll
    value = callback(transferred, key, ov)
  File "C:\Users\sanja\AppData\Local\Programs\Python\Python313\Lib\asyncio\windows_events.py", line 467, in finish_socket_func
    raise ConnectionResetError(*exc.args)
ConnectionResetError: [WinError 64] ”казанное сетевое им€ более недоступно

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
    )
    ^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\SS Sanjar\python\CityHelp_bot\midlewares\logging.py", line 26, in __call__
    response = await handler(event, data)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\SS Sanjar\python\CityHelp_bot\midlewares\auth.py", line 25, in __call__
    user = await manager.get_or_create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "D:\SS Sanjar\python\CityHelp_bot\manager\user.py", line 49, in get_or_create
    user = await self.get(user_id)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\SS Sanjar\python\CityHelp_bot\manager\user.py", line 24, in get
    result = await self.db.execute(stmt)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 449, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2239, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2108, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _connection_for_bind
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 1187, in _connection_for_bind
    conn = bind.connect()
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3277, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 143, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3301, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 447, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 1264, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 711, in checkout
    rec = pool._do_get()
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 177, in _do_get
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 175, in _do_get
    return self._create_connection()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 388, in _create_connection
    return _ConnectionRecord(self)
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 673, in __init__
    self.__connect()
    ~~~~~~~~~~~~~~^^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 899, in __connect
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 895, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\create.py", line 661, in connect
    return dialect.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 629, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 955, in connect
    await_only(creator_fn(*arg, **kw)),
    ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\asyncpg\connection.py", line 2421, in connect
    return await connect_utils._connect(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<20 lines>...
    )
    ^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\asyncpg\connect_utils.py", line 1049, in _connect
    conn = await _connect_addr(
           ^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\asyncpg\connect_utils.py", line 886, in _connect_addr
    return await __connect_addr(params, True, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\asyncpg\connect_utils.py", line 934, in __connect_addr
    await connected
asyncpg.exceptions.ConnectionDoesNotExistError: connection was closed in the middle of operation
2025-12-18 20:28:24,211 - aiogram.dispatcher - INFO - Polling stopped
2025-12-18 20:28:24,212 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected
2025-12-18 20:28:24,212 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8459808785)
2025-12-18 20:28:24,469 - aiogram.dispatcher - INFO - Polling stopped for bot @TG_Bot_5665bot id=8459808785 - 'TG_Bot_5665'
2025-12-18 20:28:28,427 - aiogram.event - INFO - Update id=846056352 is not handled. Duration 85 ms by bot id=8459808785
2025-12-18 20:28:28,427 - aiogram.event - ERROR - Cause exception while process update id=846056352 by bot id=8459808785
ConnectionDoesNotExistError: connection was closed in the middle of operation
Traceback (most recent call last):
  File "C:\Users\sanja\AppData\Local\Programs\Python\Python313\Lib\asyncio\windows_events.py", line 463, in finish_socket_func
    return ov.getresult()
           ~~~~~~~~~~~~^^
OSError: [WinError 64] ”казанное сетевое им€ более недоступно

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\sanja\AppData\Local\Programs\Python\Python313\Lib\asyncio\proactor_events.py", line 286, in _loop_reading
    length = fut.result()
  File "C:\Users\sanja\AppData\Local\Programs\Python\Python313\Lib\asyncio\windows_events.py", line 804, in _poll
    value = callback(transferred, key, ov)
  File "C:\Users\sanja\AppData\Local\Programs\Python\Python313\Lib\asyncio\windows_events.py", line 467, in finish_socket_func
    raise ConnectionResetError(*exc.args)
ConnectionResetError: [WinError 64] ”казанное сетевое им€ более недоступно

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
    )
    ^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\SS Sanjar\python\CityHelp_bot\midlewares\logging.py", line 26, in __call__
    response = await handler(event, data)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\SS Sanjar\python\CityHelp_bot\midlewares\auth.py", line 25, in __call__
    user = await manager.get_or_create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "D:\SS Sanjar\python\CityHelp_bot\manager\user.py", line 49, in get_or_create
    user = await self.get(user_id)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\SS Sanjar\python\CityHelp_bot\manager\user.py", line 24, in get
    result = await self.db.execute(stmt)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 449, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2239, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2108, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _connection_for_bind
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 1187, in _connection_for_bind
    conn = bind.connect()
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3277, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 143, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3301, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 447, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 1264, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 711, in checkout
    rec = pool._do_get()
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 177, in _do_get
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 175, in _do_get
    return self._create_connection()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 388, in _create_connection
    return _ConnectionRecord(self)
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 673, in __init__
    self.__connect()
    ~~~~~~~~~~~~~~^^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 899, in __connect
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 895, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\create.py", line 661, in connect
    return dialect.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 629, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 955, in connect
    await_only(creator_fn(*arg, **kw)),
    ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\asyncpg\connection.py", line 2421, in connect
    return await connect_utils._connect(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<20 lines>...
    )
    ^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\asyncpg\connect_utils.py", line 1049, in _connect
    conn = await _connect_addr(
           ^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\asyncpg\connect_utils.py", line 886, in _connect_addr
    return await __connect_addr(params, True, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\asyncpg\connect_utils.py", line 934, in __connect_addr
    await connected
asyncpg.exceptions.ConnectionDoesNotExistError: connection was closed in the middle of operation
2025-12-18 20:29:30,721 - aiogram.dispatcher - INFO - Polling stopped
2025-12-18 20:29:30,721 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected
2025-12-18 20:29:30,722 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8459808785)
2025-12-18 20:29:30,974 - aiogram.dispatcher - INFO - Polling stopped for bot @TG_Bot_5665bot id=8459808785 - 'TG_Bot_5665'
2025-12-18 20:29:35,084 - aiogram.event - INFO - Update id=846056353 is not handled. Duration 202 ms by bot id=8459808785
2025-12-18 20:29:35,084 - aiogram.event - ERROR - Cause exception while process update id=846056353 by bot id=8459808785
ConnectionDoesNotExistError: connection was closed in the middle of operation
Traceback (most recent call last):
  File "C:\Users\sanja\AppData\Local\Programs\Python\Python313\Lib\asyncio\windows_events.py", line 463, in finish_socket_func
    return ov.getresult()
           ~~~~~~~~~~~~^^
OSError: [WinError 64] ”казанное сетевое им€ более недоступно

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\sanja\AppData\Local\Programs\Python\Python313\Lib\asyncio\proactor_events.py", line 286, in _loop_reading
    length = fut.result()
  File "C:\Users\sanja\AppData\Local\Programs\Python\Python313\Lib\asyncio\windows_events.py", line 804, in _poll
    value = callback(transferred, key, ov)
  File "C:\Users\sanja\AppData\Local\Programs\Python\Python313\Lib\asyncio\windows_events.py", line 467, in finish_socket_func
    raise ConnectionResetError(*exc.args)
ConnectionResetError: [WinError 64] ”казанное сетевое им€ более недоступно

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
    )
    ^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\SS Sanjar\python\CityHelp_bot\midlewares\logging.py", line 26, in __call__
    response = await handler(event, data)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\SS Sanjar\python\CityHelp_bot\midlewares\auth.py", line 25, in __call__
    user = await manager.get_or_create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "D:\SS Sanjar\python\CityHelp_bot\manager\user.py", line 49, in get_or_create
    user = await self.get(user_id)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\SS Sanjar\python\CityHelp_bot\manager\user.py", line 24, in get
    result = await self.db.execute(stmt)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 449, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2239, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2108, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _connection_for_bind
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 1187, in _connection_for_bind
    conn = bind.connect()
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3277, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 143, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3301, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 447, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 1264, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 711, in checkout
    rec = pool._do_get()
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 177, in _do_get
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 175, in _do_get
    return self._create_connection()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 388, in _create_connection
    return _ConnectionRecord(self)
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 673, in __init__
    self.__connect()
    ~~~~~~~~~~~~~~^^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 899, in __connect
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 895, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\create.py", line 661, in connect
    return dialect.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 629, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 955, in connect
    await_only(creator_fn(*arg, **kw)),
    ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\asyncpg\connection.py", line 2421, in connect
    return await connect_utils._connect(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<20 lines>...
    )
    ^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\asyncpg\connect_utils.py", line 1049, in _connect
    conn = await _connect_addr(
           ^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\asyncpg\connect_utils.py", line 886, in _connect_addr
    return await __connect_addr(params, True, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\asyncpg\connect_utils.py", line 934, in __connect_addr
    await connected
asyncpg.exceptions.ConnectionDoesNotExistError: connection was closed in the middle of operation
2025-12-18 20:31:00,828 - aiogram.dispatcher - INFO - Polling stopped
2025-12-18 20:31:00,829 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected
2025-12-18 20:31:00,829 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8459808785)
2025-12-18 20:31:01,088 - aiogram.dispatcher - INFO - Polling stopped for bot @TG_Bot_5665bot id=8459808785 - 'TG_Bot_5665'
2025-12-18 20:31:08,045 - aiogram.event - INFO - Update id=846056354 is not handled. Duration 91 ms by bot id=8459808785
2025-12-18 20:31:08,046 - aiogram.event - ERROR - Cause exception while process update id=846056354 by bot id=8459808785
ConnectionDoesNotExistError: connection was closed in the middle of operation
Traceback (most recent call last):
  File "C:\Users\sanja\AppData\Local\Programs\Python\Python313\Lib\asyncio\selector_events.py", line 1005, in _read_ready__data_received
    data = self._sock.recv(self.max_size)
ConnectionResetError: [WinError 10054] ”даленный хост принудительно разорвал существующее подключение

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
    )
    ^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\SS Sanjar\python\CityHelp_bot\midlewares\logging.py", line 26, in __call__
    response = await handler(event, data)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\SS Sanjar\python\CityHelp_bot\midlewares\auth.py", line 25, in __call__
    user = await manager.get_or_create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "D:\SS Sanjar\python\CityHelp_bot\manager\user.py", line 49, in get_or_create
    user = await self.get(user_id)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\SS Sanjar\python\CityHelp_bot\manager\user.py", line 24, in get
    result = await self.db.execute(stmt)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 449, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2239, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2108, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _connection_for_bind
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 1187, in _connection_for_bind
    conn = bind.connect()
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3277, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 143, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3301, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 447, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 1264, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 711, in checkout
    rec = pool._do_get()
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 177, in _do_get
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 175, in _do_get
    return self._create_connection()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 388, in _create_connection
    return _ConnectionRecord(self)
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 673, in __init__
    self.__connect()
    ~~~~~~~~~~~~~~^^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 899, in __connect
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 895, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\create.py", line 661, in connect
    return dialect.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 629, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 955, in connect
    await_only(creator_fn(*arg, **kw)),
    ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\asyncpg\connection.py", line 2421, in connect
    return await connect_utils._connect(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<20 lines>...
    )
    ^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\asyncpg\connect_utils.py", line 1049, in _connect
    conn = await _connect_addr(
           ^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\asyncpg\connect_utils.py", line 886, in _connect_addr
    return await __connect_addr(params, True, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\SS Sanjar\python\CityHelp_bot\venv\Lib\site-packages\asyncpg\connect_utils.py", line 934, in __connect_addr
    await connected
asyncpg.exceptions.ConnectionDoesNotExistError: connection was closed in the middle of operation
2025-12-20 18:22:03,821 - aiogram.event - INFO - Update id=846056355 is not handled. Duration 369 ms by bot id=8459808785
2025-12-20 18:22:03,821 - aiogram.event - ERROR - Cause exception while process update id=846056355 by bot id=8459808785
InvalidRequestError: Mapper 'Mapper[Report(reports)]' has no property 'request'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
Traceback (most recent call last):
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2522, in get_property
    return self._props[key]
           ~~~~~~~~~~~^^^^^
KeyError: 'request'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\midlewares\logging.py", line 26, in __call__
    response = await handler(event, data)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\midlewares\auth.py", line 25, in __call__
    user = await manager.get_or_create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\manager\user.py", line 49, in get_or_create
    user = await self.get(user_id)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\manager\user.py", line 24, in get
    result = await self.db.execute(stmt)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 449, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2249, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self,
        ^^^^^
    ...<4 lines>...
        conn,
        ^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
        statement, params or {}, execution_options=execution_options
    )
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1633, in _execute_clauseelement
    compiled_sql, extracted_params, cache_hit = elem._compile_w_cache(
                                                ~~~~~~~~~~~~~~~~~~~~~^
        dialect=dialect,
        ^^^^^^^^^^^^^^^^
    ...<4 lines>...
        linting=self.dialect.compiler_linting | compiler.WARN_LINTING,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 715, in _compile_w_cache
    compiled_sql = self._compiler(
        dialect,
    ...<4 lines>...
        **kw,
    )
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 323, in _compiler
    return dialect.statement_compiler(dialect, self, **kw)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 1446, in __init__
    Compiled.__init__(self, dialect, statement, **kwargs)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 886, in __init__
    self.string = self.process(self.statement, **compile_kwargs)
                  ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 932, in process
    return obj._compiler_dispatch(self, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\sql\visitors.py", line 138, in _compiler_dispatch
    return meth(self, **kw)  # type: ignore  # noqa: E501
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 4781, in visit_select
    compile_state = select_stmt._compile_state_factory(
        select_stmt, self, **kwargs
    )
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\sql\base.py", line 701, in create_for_statement
    return klass.create_for_statement(statement, compiler, **kw)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\orm\context.py", line 447, in create_for_statement
    return cls._create_orm_context(
           ~~~~~~~~~~~~~~~~~~~~~~~^
        cast("Union[Select, FromStatement]", statement),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        **kw,
        ^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\orm\context.py", line 1175, in _create_orm_context
    _QueryEntity.to_compile_state(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self,
        ^^^^^
    ...<2 lines>...
        is_current_entities=True,
        ^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\orm\context.py", line 2628, in to_compile_state
    _MapperEntity(
    ~~~~~~~~~~~~~^
        compile_state,
        ^^^^^^^^^^^^^^
    ...<2 lines>...
        is_current_entities,
        ^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\orm\context.py", line 2708, in __init__
    entity._post_inspect
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1338, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
                                           ~~~~~~~~~^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2724, in _post_inspect
    self._check_configure()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2401, in _check_configure
    _configure_registries({self.registry}, cascade=True)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4218, in _configure_registries
    _do_configure_registries(registries, cascade)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4259, in _do_configure_registries
    mapper._post_configure_properties()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2418, in _post_configure_properties
    prop.init()
    ~~~~~~~~~^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\orm\interfaces.py", line 595, in init
    self.do_init()
    ~~~~~~~~~~~~^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1660, in do_init
    self._generate_backref()
    ~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2144, in _generate_backref
    self._add_reverse_property(self.back_populates)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1591, in _add_reverse_property
    other = self.mapper.get_property(key, _configure_mappers=False)
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2524, in get_property
    raise sa_exc.InvalidRequestError(
    ...<3 lines>...
    ) from err
sqlalchemy.exc.InvalidRequestError: Mapper 'Mapper[Report(reports)]' has no property 'request'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-12-20 18:24:45,069 - aiogram.dispatcher - INFO - Polling stopped
2025-12-20 18:24:45,335 - aiogram.dispatcher - INFO - Polling stopped for bot @TG_Bot_5665bot id=8459808785 - 'TG_Bot_5665'
2025-12-20 18:24:45,541 - asyncio - ERROR - Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x000001C488E4E0D0>
2025-12-20 18:24:50,959 - aiogram.event - INFO - Update id=846056356 is not handled. Duration 328 ms by bot id=8459808785
2025-12-20 18:24:50,959 - aiogram.event - ERROR - Cause exception while process update id=846056356 by bot id=8459808785
ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: столбец users.phone не существует
[SQL: SELECT users.id, users.full_name, users.language, users.phone, users.created_at, users.role 
FROM users 
WHERE users.id = $1::BIGINT]
[parameters: (5688458167,)]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 526, in _prepare_and_execute
    prepared_stmt, attributes = await adapt_connection._prepare(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        operation, self._invalidate_schema_cache_asof
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 773, in _prepare
    prepared_stmt = await self._connection.prepare(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        operation, name=self._prepared_statement_name_func()
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\asyncpg\connection.py", line 635, in prepare
    return await self._prepare(
           ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\asyncpg\connection.py", line 653, in _prepare
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\asyncpg\connection.py", line 432, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "asyncpg\\protocol\\protocol.pyx", line 165, in prepare
asyncpg.exceptions.UndefinedColumnError: столбец users.phone не существует

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self._prepare_and_execute(operation, parameters)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: столбец users.phone не существует

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\midlewares\logging.py", line 26, in __call__
    response = await handler(event, data)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\midlewares\auth.py", line 25, in __call__
    user = await manager.get_or_create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\manager\user.py", line 49, in get_or_create
    user = await self.get(user_id)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\manager\user.py", line 24, in get
    result = await self.db.execute(stmt)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 449, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2249, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self,
        ^^^^^
    ...<4 lines>...
        conn,
        ^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
        statement, params or {}, execution_options=execution_options
    )
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ~~~~~~~~~~~~~~~~~~~~~~~~~^
        dialect, context, statement, parameters
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e, str_statement, effective_parameters, cursor, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self._prepare_and_execute(operation, parameters)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: столбец users.phone не существует
[SQL: SELECT users.id, users.full_name, users.language, users.phone, users.created_at, users.role 
FROM users 
WHERE users.id = $1::BIGINT]
[parameters: (5688458167,)]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-12-20 18:26:06,637 - aiogram.dispatcher - INFO - Polling stopped
2025-12-20 18:26:06,638 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected
2025-12-20 18:26:06,639 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8459808785)
2025-12-20 18:26:06,904 - aiogram.dispatcher - INFO - Polling stopped for bot @TG_Bot_5665bot id=8459808785 - 'TG_Bot_5665'
2025-12-20 18:26:12,574 - aiogram.event - INFO - Update id=846056357 is not handled. Duration 110 ms by bot id=8459808785
2025-12-20 18:26:12,574 - aiogram.event - ERROR - Cause exception while process update id=846056357 by bot id=8459808785
ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: столбец users.phone не существует
[SQL: SELECT users.id, users.full_name, users.language, users.phone, users.created_at, users.role 
FROM users 
WHERE users.id = $1::BIGINT]
[parameters: (5688458167,)]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 526, in _prepare_and_execute
    prepared_stmt, attributes = await adapt_connection._prepare(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        operation, self._invalidate_schema_cache_asof
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 773, in _prepare
    prepared_stmt = await self._connection.prepare(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        operation, name=self._prepared_statement_name_func()
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\asyncpg\connection.py", line 635, in prepare
    return await self._prepare(
           ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\asyncpg\connection.py", line 653, in _prepare
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\asyncpg\connection.py", line 432, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "asyncpg\\protocol\\protocol.pyx", line 165, in prepare
asyncpg.exceptions.UndefinedColumnError: столбец users.phone не существует

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self._prepare_and_execute(operation, parameters)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: столбец users.phone не существует

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\midlewares\logging.py", line 26, in __call__
    response = await handler(event, data)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\midlewares\auth.py", line 25, in __call__
    user = await manager.get_or_create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\manager\user.py", line 49, in get_or_create
    user = await self.get(user_id)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\manager\user.py", line 24, in get
    result = await self.db.execute(stmt)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 449, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2249, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self,
        ^^^^^
    ...<4 lines>...
        conn,
        ^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
        statement, params or {}, execution_options=execution_options
    )
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ~~~~~~~~~~~~~~~~~~~~~~~~~^
        dialect, context, statement, parameters
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e, str_statement, effective_parameters, cursor, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self._prepare_and_execute(operation, parameters)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: столбец users.phone не существует
[SQL: SELECT users.id, users.full_name, users.language, users.phone, users.created_at, users.role 
FROM users 
WHERE users.id = $1::BIGINT]
[parameters: (5688458167,)]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-12-20 18:26:43,037 - aiogram.dispatcher - INFO - Polling stopped
2025-12-20 18:26:43,301 - aiogram.dispatcher - INFO - Polling stopped for bot @TG_Bot_5665bot id=8459808785 - 'TG_Bot_5665'
2025-12-20 18:26:43,637 - asyncio - ERROR - Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x00000283E2C05D10>
2025-12-20 18:26:48,705 - aiogram.event - INFO - Update id=846056358 is not handled. Duration 105 ms by bot id=8459808785
2025-12-20 18:26:48,706 - aiogram.event - ERROR - Cause exception while process update id=846056358 by bot id=8459808785
ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: столбец users.phone не существует
[SQL: SELECT users.id, users.full_name, users.language, users.phone, users.created_at, users.role 
FROM users 
WHERE users.id = $1::BIGINT]
[parameters: (5688458167,)]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 526, in _prepare_and_execute
    prepared_stmt, attributes = await adapt_connection._prepare(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        operation, self._invalidate_schema_cache_asof
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 773, in _prepare
    prepared_stmt = await self._connection.prepare(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        operation, name=self._prepared_statement_name_func()
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\asyncpg\connection.py", line 635, in prepare
    return await self._prepare(
           ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\asyncpg\connection.py", line 653, in _prepare
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\asyncpg\connection.py", line 432, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "asyncpg\\protocol\\protocol.pyx", line 165, in prepare
asyncpg.exceptions.UndefinedColumnError: столбец users.phone не существует

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self._prepare_and_execute(operation, parameters)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: столбец users.phone не существует

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\midlewares\logging.py", line 26, in __call__
    response = await handler(event, data)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\midlewares\auth.py", line 25, in __call__
    user = await manager.get_or_create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\manager\user.py", line 49, in get_or_create
    user = await self.get(user_id)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\manager\user.py", line 24, in get
    result = await self.db.execute(stmt)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 449, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2249, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self,
        ^^^^^
    ...<4 lines>...
        conn,
        ^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
        statement, params or {}, execution_options=execution_options
    )
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ~~~~~~~~~~~~~~~~~~~~~~~~~^
        dialect, context, statement, parameters
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e, str_statement, effective_parameters, cursor, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self._prepare_and_execute(operation, parameters)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: столбец users.phone не существует
[SQL: SELECT users.id, users.full_name, users.language, users.phone, users.created_at, users.role 
FROM users 
WHERE users.id = $1::BIGINT]
[parameters: (5688458167,)]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-12-20 18:26:49,020 - aiogram.event - INFO - Update id=846056359 is not handled. Duration 5 ms by bot id=8459808785
2025-12-20 18:26:49,020 - aiogram.event - ERROR - Cause exception while process update id=846056359 by bot id=8459808785
ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: столбец users.phone не существует
[SQL: SELECT users.id, users.full_name, users.language, users.phone, users.created_at, users.role 
FROM users 
WHERE users.id = $1::BIGINT]
[parameters: (5688458167,)]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 526, in _prepare_and_execute
    prepared_stmt, attributes = await adapt_connection._prepare(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        operation, self._invalidate_schema_cache_asof
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 773, in _prepare
    prepared_stmt = await self._connection.prepare(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        operation, name=self._prepared_statement_name_func()
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\asyncpg\connection.py", line 635, in prepare
    return await self._prepare(
           ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\asyncpg\connection.py", line 653, in _prepare
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\asyncpg\connection.py", line 432, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "asyncpg\\protocol\\protocol.pyx", line 165, in prepare
asyncpg.exceptions.UndefinedColumnError: столбец users.phone не существует

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self._prepare_and_execute(operation, parameters)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: столбец users.phone не существует

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\midlewares\logging.py", line 26, in __call__
    response = await handler(event, data)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\midlewares\auth.py", line 25, in __call__
    user = await manager.get_or_create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\manager\user.py", line 49, in get_or_create
    user = await self.get(user_id)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\manager\user.py", line 24, in get
    result = await self.db.execute(stmt)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 449, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2249, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self,
        ^^^^^
    ...<4 lines>...
        conn,
        ^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
        statement, params or {}, execution_options=execution_options
    )
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ~~~~~~~~~~~~~~~~~~~~~~~~~^
        dialect, context, statement, parameters
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e, str_statement, effective_parameters, cursor, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self._prepare_and_execute(operation, parameters)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: столбец users.phone не существует
[SQL: SELECT users.id, users.full_name, users.language, users.phone, users.created_at, users.role 
FROM users 
WHERE users.id = $1::BIGINT]
[parameters: (5688458167,)]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-12-20 18:31:28,736 - aiogram.dispatcher - INFO - Polling stopped
2025-12-20 18:31:29,001 - aiogram.dispatcher - INFO - Polling stopped for bot @TG_Bot_5665bot id=8459808785 - 'TG_Bot_5665'
2025-12-20 18:31:29,167 - asyncio - ERROR - Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x0000021387C64690>
2025-12-20 18:40:38,206 - aiogram.event - INFO - Update id=846056360 is not handled. Duration 2 ms by bot id=8459808785
2025-12-20 18:40:38,207 - aiogram.event - ERROR - Cause exception while process update id=846056360 by bot id=8459808785
TypeError: UserManager.get_or_create() got an unexpected keyword argument 'phone'
Traceback (most recent call last):
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\midlewares\logging.py", line 26, in __call__
    response = await handler(event, data)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\midlewares\auth.py", line 25, in __call__
    user = await manager.get_or_create(
                 ~~~~~~~~~~~~~~~~~~~~~^
        user_id=from_user.id,
        ^^^^^^^^^^^^^^^^^^^^^
        full_name=from_user.full_name,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        phone=None,
        ^^^^^^^^^^^
    )
    ^
TypeError: UserManager.get_or_create() got an unexpected keyword argument 'phone'
2025-12-20 18:40:53,080 - aiogram.dispatcher - INFO - Polling stopped
2025-12-20 18:40:53,084 - aiogram.event - INFO - Update id=846056361 is not handled. Duration 2 ms by bot id=8459808785
2025-12-20 18:40:53,084 - aiogram.event - ERROR - Cause exception while process update id=846056361 by bot id=8459808785
TypeError: UserManager.get_or_create() got an unexpected keyword argument 'phone'
Traceback (most recent call last):
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\midlewares\logging.py", line 26, in __call__
    response = await handler(event, data)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\midlewares\auth.py", line 25, in __call__
    user = await manager.get_or_create(
                 ^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    data["user"] = user
    ^
TypeError: UserManager.get_or_create() got an unexpected keyword argument 'phone'
2025-12-20 18:40:53,343 - aiogram.dispatcher - INFO - Polling stopped for bot @TG_Bot_5665bot id=8459808785 - 'TG_Bot_5665'
2025-12-20 18:40:53,511 - asyncio - ERROR - Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x00000211355AE210>
2025-12-20 18:40:58,321 - aiogram.event - INFO - Update id=846056362 is not handled. Duration 107 ms by bot id=8459808785
2025-12-20 18:40:58,322 - aiogram.event - ERROR - Cause exception while process update id=846056362 by bot id=8459808785
ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: столбец users.phone не существует
[SQL: SELECT users.id, users.full_name, users.language, users.phone, users.created_at, users.role 
FROM users 
WHERE users.id = $1::BIGINT]
[parameters: (5688458167,)]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 526, in _prepare_and_execute
    prepared_stmt, attributes = await adapt_connection._prepare(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        operation, self._invalidate_schema_cache_asof
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 773, in _prepare
    prepared_stmt = await self._connection.prepare(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        operation, name=self._prepared_statement_name_func()
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\asyncpg\connection.py", line 635, in prepare
    return await self._prepare(
           ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\asyncpg\connection.py", line 653, in _prepare
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\asyncpg\connection.py", line 432, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "asyncpg\\protocol\\protocol.pyx", line 165, in prepare
asyncpg.exceptions.UndefinedColumnError: столбец users.phone не существует

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self._prepare_and_execute(operation, parameters)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: столбец users.phone не существует

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\midlewares\logging.py", line 26, in __call__
    response = await handler(event, data)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\midlewares\auth.py", line 25, in __call__
    user = await manager.get_or_create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\manager\user.py", line 53, in get_or_create
    user = await self.get(user_id)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\manager\user.py", line 23, in get
    result = await self.db.execute(stmt)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 449, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2249, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self,
        ^^^^^
    ...<4 lines>...
        conn,
        ^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
        statement, params or {}, execution_options=execution_options
    )
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ~~~~~~~~~~~~~~~~~~~~~~~~~^
        dialect, context, statement, parameters
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e, str_statement, effective_parameters, cursor, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self._prepare_and_execute(operation, parameters)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: столбец users.phone не существует
[SQL: SELECT users.id, users.full_name, users.language, users.phone, users.created_at, users.role 
FROM users 
WHERE users.id = $1::BIGINT]
[parameters: (5688458167,)]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-12-20 18:42:49,148 - aiogram.event - INFO - Update id=846056363 is not handled. Duration 4 ms by bot id=8459808785
2025-12-20 18:42:49,149 - aiogram.event - ERROR - Cause exception while process update id=846056363 by bot id=8459808785
ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: столбец users.phone не существует
[SQL: SELECT users.id, users.full_name, users.language, users.phone, users.created_at, users.role 
FROM users 
WHERE users.id = $1::BIGINT]
[parameters: (5688458167,)]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 526, in _prepare_and_execute
    prepared_stmt, attributes = await adapt_connection._prepare(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        operation, self._invalidate_schema_cache_asof
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 773, in _prepare
    prepared_stmt = await self._connection.prepare(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        operation, name=self._prepared_statement_name_func()
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\asyncpg\connection.py", line 635, in prepare
    return await self._prepare(
           ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\asyncpg\connection.py", line 653, in _prepare
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\asyncpg\connection.py", line 432, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "asyncpg\\protocol\\protocol.pyx", line 165, in prepare
asyncpg.exceptions.UndefinedColumnError: столбец users.phone не существует

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self._prepare_and_execute(operation, parameters)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: столбец users.phone не существует

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\midlewares\logging.py", line 26, in __call__
    response = await handler(event, data)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\midlewares\auth.py", line 25, in __call__
    #             user = await manager.get_or_create(
    ...<2 lines>...
    #             )
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\manager\user.py", line 53, in get_or_create
    user = await self.get(user_id)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\manager\user.py", line 23, in get
    result = await self.db.execute(stmt)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 449, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2249, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self,
        ^^^^^
    ...<4 lines>...
        conn,
        ^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
        statement, params or {}, execution_options=execution_options
    )
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ~~~~~~~~~~~~~~~~~~~~~~~~~^
        dialect, context, statement, parameters
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e, str_statement, effective_parameters, cursor, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self._prepare_and_execute(operation, parameters)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: столбец users.phone не существует
[SQL: SELECT users.id, users.full_name, users.language, users.phone, users.created_at, users.role 
FROM users 
WHERE users.id = $1::BIGINT]
[parameters: (5688458167,)]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-12-20 18:43:39,659 - aiogram.dispatcher - INFO - Polling stopped
2025-12-20 18:43:39,925 - aiogram.dispatcher - INFO - Polling stopped for bot @TG_Bot_5665bot id=8459808785 - 'TG_Bot_5665'
2025-12-20 18:43:40,066 - asyncio - ERROR - Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x00000132057F4690>
2025-12-20 18:43:45,082 - aiogram.event - INFO - Update id=846056364 is not handled. Duration 106 ms by bot id=8459808785
2025-12-20 18:43:45,082 - aiogram.event - ERROR - Cause exception while process update id=846056364 by bot id=8459808785
ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: столбец users.phone не существует
[SQL: SELECT users.id, users.full_name, users.language, users.phone, users.created_at, users.role 
FROM users 
WHERE users.id = $1::BIGINT]
[parameters: (5688458167,)]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 526, in _prepare_and_execute
    prepared_stmt, attributes = await adapt_connection._prepare(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        operation, self._invalidate_schema_cache_asof
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 773, in _prepare
    prepared_stmt = await self._connection.prepare(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        operation, name=self._prepared_statement_name_func()
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\asyncpg\connection.py", line 635, in prepare
    return await self._prepare(
           ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\asyncpg\connection.py", line 653, in _prepare
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\asyncpg\connection.py", line 432, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "asyncpg\\protocol\\protocol.pyx", line 165, in prepare
asyncpg.exceptions.UndefinedColumnError: столбец users.phone не существует

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self._prepare_and_execute(operation, parameters)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: столбец users.phone не существует

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\midlewares\logging.py", line 26, in __call__
    response = await handler(event, data)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\midlewares\auth.py", line 25, in __call__
    user = await manager.get_or_create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\manager\user.py", line 53, in get_or_create
    user = await self.get(user_id)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\manager\user.py", line 23, in get
    result = await self.db.execute(stmt)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 449, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2249, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self,
        ^^^^^
    ...<4 lines>...
        conn,
        ^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
        statement, params or {}, execution_options=execution_options
    )
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ~~~~~~~~~~~~~~~~~~~~~~~~~^
        dialect, context, statement, parameters
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e, str_statement, effective_parameters, cursor, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self._prepare_and_execute(operation, parameters)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: столбец users.phone не существует
[SQL: SELECT users.id, users.full_name, users.language, users.phone, users.created_at, users.role 
FROM users 
WHERE users.id = $1::BIGINT]
[parameters: (5688458167,)]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-12-20 18:45:36,093 - aiogram.dispatcher - INFO - Polling stopped
2025-12-20 18:45:36,358 - aiogram.dispatcher - INFO - Polling stopped for bot @TG_Bot_5665bot id=8459808785 - 'TG_Bot_5665'
2025-12-20 18:45:36,504 - asyncio - ERROR - Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x00000274D73C5D10>
2025-12-20 18:48:58,092 - aiogram.event - INFO - Update id=846056365 is not handled. Duration 146 ms by bot id=8459808785
2025-12-20 18:48:58,093 - aiogram.event - ERROR - Cause exception while process update id=846056365 by bot id=8459808785
ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: столбец users.phone не существует
[SQL: SELECT users.id, users.full_name, users.language, users.phone, users.created_at, users.role 
FROM users 
WHERE users.id = $1::BIGINT]
[parameters: (5688458167,)]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 526, in _prepare_and_execute
    prepared_stmt, attributes = await adapt_connection._prepare(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        operation, self._invalidate_schema_cache_asof
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 773, in _prepare
    prepared_stmt = await self._connection.prepare(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        operation, name=self._prepared_statement_name_func()
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\asyncpg\connection.py", line 635, in prepare
    return await self._prepare(
           ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\asyncpg\connection.py", line 653, in _prepare
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\asyncpg\connection.py", line 432, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "asyncpg\\protocol\\protocol.pyx", line 165, in prepare
asyncpg.exceptions.UndefinedColumnError: столбец users.phone не существует

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self._prepare_and_execute(operation, parameters)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: столбец users.phone не существует

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\midlewares\logging.py", line 26, in __call__
    response = await handler(event, data)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\midlewares\auth.py", line 25, in __call__
    user = await manager.get_or_create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\manager\user.py", line 53, in get_or_create
    user = await self.get(user_id)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\manager\user.py", line 23, in get
    result = await self.db.execute(stmt)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 449, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2249, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self,
        ^^^^^
    ...<4 lines>...
        conn,
        ^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
        statement, params or {}, execution_options=execution_options
    )
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ~~~~~~~~~~~~~~~~~~~~~~~~~^
        dialect, context, statement, parameters
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e, str_statement, effective_parameters, cursor, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self._prepare_and_execute(operation, parameters)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: столбец users.phone не существует
[SQL: SELECT users.id, users.full_name, users.language, users.phone, users.created_at, users.role 
FROM users 
WHERE users.id = $1::BIGINT]
[parameters: (5688458167,)]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-12-20 18:50:28,882 - aiogram.dispatcher - INFO - Polling stopped
2025-12-20 18:50:29,147 - aiogram.dispatcher - INFO - Polling stopped for bot @TG_Bot_5665bot id=8459808785 - 'TG_Bot_5665'
2025-12-20 18:50:29,314 - asyncio - ERROR - Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x000001F5608D5D10>
2025-12-20 18:50:46,705 - aiogram.event - INFO - Update id=846056367 is not handled. Duration 200 ms by bot id=8459808785
2025-12-20 18:50:46,705 - aiogram.event - ERROR - Cause exception while process update id=846056367 by bot id=8459808785
ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: столбец users.phone не существует
[SQL: SELECT users.id, users.full_name, users.language, users.phone, users.created_at, users.role 
FROM users 
WHERE users.id = $1::BIGINT]
[parameters: (5688458167,)]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 526, in _prepare_and_execute
    prepared_stmt, attributes = await adapt_connection._prepare(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        operation, self._invalidate_schema_cache_asof
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 773, in _prepare
    prepared_stmt = await self._connection.prepare(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        operation, name=self._prepared_statement_name_func()
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\asyncpg\connection.py", line 635, in prepare
    return await self._prepare(
           ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\asyncpg\connection.py", line 653, in _prepare
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\asyncpg\connection.py", line 432, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "asyncpg\\protocol\\protocol.pyx", line 165, in prepare
asyncpg.exceptions.UndefinedColumnError: столбец users.phone не существует

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self._prepare_and_execute(operation, parameters)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: столбец users.phone не существует

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\midlewares\logging.py", line 26, in __call__
    response = await handler(event, data)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\midlewares\auth.py", line 25, in __call__
    user = await manager.get_or_create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\manager\user.py", line 53, in get_or_create
    user = await self.get(user_id)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\manager\user.py", line 23, in get
    result = await self.db.execute(stmt)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 449, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2249, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self,
        ^^^^^
    ...<4 lines>...
        conn,
        ^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
        statement, params or {}, execution_options=execution_options
    )
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ~~~~~~~~~~~~~~~~~~~~~~~~~^
        dialect, context, statement, parameters
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e, str_statement, effective_parameters, cursor, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self._prepare_and_execute(operation, parameters)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: столбец users.phone не существует
[SQL: SELECT users.id, users.full_name, users.language, users.phone, users.created_at, users.role 
FROM users 
WHERE users.id = $1::BIGINT]
[parameters: (5688458167,)]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-12-20 18:50:46,733 - aiogram.event - INFO - Update id=846056366 is not handled. Duration 233 ms by bot id=8459808785
2025-12-20 18:50:46,733 - aiogram.event - ERROR - Cause exception while process update id=846056366 by bot id=8459808785
ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: столбец users.phone не существует
[SQL: SELECT users.id, users.full_name, users.language, users.phone, users.created_at, users.role 
FROM users 
WHERE users.id = $1::BIGINT]
[parameters: (5688458167,)]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 526, in _prepare_and_execute
    prepared_stmt, attributes = await adapt_connection._prepare(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        operation, self._invalidate_schema_cache_asof
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 773, in _prepare
    prepared_stmt = await self._connection.prepare(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        operation, name=self._prepared_statement_name_func()
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\asyncpg\connection.py", line 635, in prepare
    return await self._prepare(
           ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\asyncpg\connection.py", line 653, in _prepare
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\asyncpg\connection.py", line 432, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "asyncpg\\protocol\\protocol.pyx", line 165, in prepare
asyncpg.exceptions.UndefinedColumnError: столбец users.phone не существует

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self._prepare_and_execute(operation, parameters)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: столбец users.phone не существует

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\midlewares\logging.py", line 26, in __call__
    response = await handler(event, data)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\midlewares\auth.py", line 25, in __call__
    user = await manager.get_or_create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\manager\user.py", line 53, in get_or_create
    user = await self.get(user_id)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\manager\user.py", line 23, in get
    result = await self.db.execute(stmt)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 449, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2249, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self,
        ^^^^^
    ...<4 lines>...
        conn,
        ^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
        statement, params or {}, execution_options=execution_options
    )
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ~~~~~~~~~~~~~~~~~~~~~~~~~^
        dialect, context, statement, parameters
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e, str_statement, effective_parameters, cursor, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self._prepare_and_execute(operation, parameters)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: столбец users.phone не существует
[SQL: SELECT users.id, users.full_name, users.language, users.phone, users.created_at, users.role 
FROM users 
WHERE users.id = $1::BIGINT]
[parameters: (5688458167,)]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-12-20 18:52:42,627 - aiogram.dispatcher - INFO - Polling stopped
2025-12-20 18:52:42,628 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected
2025-12-20 18:52:42,628 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8459808785)
2025-12-20 18:52:42,891 - aiogram.dispatcher - INFO - Polling stopped for bot @TG_Bot_5665bot id=8459808785 - 'TG_Bot_5665'
2025-12-20 18:57:42,478 - aiogram.event - INFO - Update id=846056368 is not handled. Duration 191 ms by bot id=8459808785
2025-12-20 18:57:42,479 - aiogram.event - ERROR - Cause exception while process update id=846056368 by bot id=8459808785
ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: столбец users.phone не существует
[SQL: SELECT users.id, users.full_name, users.language, users.phone, users.created_at, users.role 
FROM users 
WHERE users.id = $1::BIGINT]
[parameters: (5688458167,)]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 526, in _prepare_and_execute
    prepared_stmt, attributes = await adapt_connection._prepare(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        operation, self._invalidate_schema_cache_asof
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 773, in _prepare
    prepared_stmt = await self._connection.prepare(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        operation, name=self._prepared_statement_name_func()
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\asyncpg\connection.py", line 635, in prepare
    return await self._prepare(
           ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\asyncpg\connection.py", line 653, in _prepare
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\asyncpg\connection.py", line 432, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "asyncpg\\protocol\\protocol.pyx", line 165, in prepare
asyncpg.exceptions.UndefinedColumnError: столбец users.phone не существует

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self._prepare_and_execute(operation, parameters)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: столбец users.phone не существует

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\midlewares\logging.py", line 26, in __call__
    response = await handler(event, data)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\midlewares\auth.py", line 25, in __call__
    user = await manager.get_or_create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\manager\user.py", line 53, in get_or_create
    user = await self.get(user_id)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\manager\user.py", line 23, in get
    result = await self.db.execute(stmt)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 449, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2249, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self,
        ^^^^^
    ...<4 lines>...
        conn,
        ^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
        statement, params or {}, execution_options=execution_options
    )
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ~~~~~~~~~~~~~~~~~~~~~~~~~^
        dialect, context, statement, parameters
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e, str_statement, effective_parameters, cursor, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self._prepare_and_execute(operation, parameters)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: столбец users.phone не существует
[SQL: SELECT users.id, users.full_name, users.language, users.phone, users.created_at, users.role 
FROM users 
WHERE users.id = $1::BIGINT]
[parameters: (5688458167,)]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-12-20 19:00:39,635 - aiogram.dispatcher - INFO - Polling stopped
2025-12-20 19:00:39,636 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected
2025-12-20 19:00:39,636 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8459808785)
2025-12-20 19:00:39,900 - aiogram.dispatcher - INFO - Polling stopped for bot @TG_Bot_5665bot id=8459808785 - 'TG_Bot_5665'
2025-12-20 19:00:47,991 - aiogram.event - INFO - Update id=846056369 is not handled. Duration 225 ms by bot id=8459808785
2025-12-20 19:00:47,992 - aiogram.event - ERROR - Cause exception while process update id=846056369 by bot id=8459808785
CompileError: Unconsumed column names: user_id
Traceback (most recent call last):
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\midlewares\logging.py", line 26, in __call__
    response = await handler(event, data)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\midlewares\auth.py", line 25, in __call__
    user = await manager.get_or_create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\manager\user.py", line 55, in get_or_create
    user = await self.create(user_id,full_name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\manager\user.py", line 17, in create
    result = await self.db.execute(stmt)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 449, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 190, in greenlet_spawn
    result = context.switch(*args, **kwargs)
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2249, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self,
        ^^^^^
    ...<4 lines>...
        conn,
        ^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\orm\bulk_persistence.py", line 1306, in orm_execute_statement
    result = conn.execute(
        statement, params or {}, execution_options=execution_options
    )
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1633, in _execute_clauseelement
    compiled_sql, extracted_params, cache_hit = elem._compile_w_cache(
                                                ~~~~~~~~~~~~~~~~~~~~~^
        dialect=dialect,
        ^^^^^^^^^^^^^^^^
    ...<4 lines>...
        linting=self.dialect.compiler_linting | compiler.WARN_LINTING,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 715, in _compile_w_cache
    compiled_sql = self._compiler(
        dialect,
    ...<4 lines>...
        **kw,
    )
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 323, in _compiler
    return dialect.statement_compiler(dialect, self, **kw)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 1446, in __init__
    Compiled.__init__(self, dialect, statement, **kwargs)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 886, in __init__
    self.string = self.process(self.statement, **compile_kwargs)
                  ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 932, in process
    return obj._compiler_dispatch(self, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\sql\annotation.py", line 344, in _compiler_dispatch
    return self.__element.__class__._compiler_dispatch(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, visitor, **kw
        ^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\sql\visitors.py", line 138, in _compiler_dispatch
    return meth(self, **kw)  # type: ignore  # noqa: E501
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 5896, in visit_insert
    crud_params_struct = crud._get_crud_params(
        self,
    ...<4 lines>...
        **kw,
    )
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\sql\crud.py", line 381, in _get_crud_params
    raise exc.CompileError(
    ...<2 lines>...
    )
sqlalchemy.exc.CompileError: Unconsumed column names: user_id
2025-12-20 19:02:11,229 - aiogram.dispatcher - INFO - Polling stopped
2025-12-20 19:02:11,237 - aiogram.event - INFO - Update id=846056370 is not handled. Duration 6 ms by bot id=8459808785
2025-12-20 19:02:11,237 - aiogram.event - ERROR - Cause exception while process update id=846056370 by bot id=8459808785
CompileError: Unconsumed column names: user_id
Traceback (most recent call last):
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\midlewares\logging.py", line 26, in __call__
    response = await handler(event, data)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\midlewares\auth.py", line 25, in __call__
    user = await manager.get_or_create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\manager\user.py", line 55, in get_or_create
    user = await self.create(id,full_name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\manager\user.py", line 17, in create
    result = await self.db.execute(stmt)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 449, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 190, in greenlet_spawn
    result = context.switch(*args, **kwargs)
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2249, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self,
        ^^^^^
    ...<4 lines>...
        conn,
        ^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\orm\bulk_persistence.py", line 1306, in orm_execute_statement
    result = conn.execute(
        statement, params or {}, execution_options=execution_options
    )
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1633, in _execute_clauseelement
    compiled_sql, extracted_params, cache_hit = elem._compile_w_cache(
                                                ~~~~~~~~~~~~~~~~~~~~~^
        dialect=dialect,
        ^^^^^^^^^^^^^^^^
    ...<4 lines>...
        linting=self.dialect.compiler_linting | compiler.WARN_LINTING,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 715, in _compile_w_cache
    compiled_sql = self._compiler(
        dialect,
    ...<4 lines>...
        **kw,
    )
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 323, in _compiler
    return dialect.statement_compiler(dialect, self, **kw)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 1446, in __init__
    Compiled.__init__(self, dialect, statement, **kwargs)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 886, in __init__
    self.string = self.process(self.statement, **compile_kwargs)
                  ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 932, in process
    return obj._compiler_dispatch(self, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\sql\annotation.py", line 344, in _compiler_dispatch
    return self.__element.__class__._compiler_dispatch(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, visitor, **kw
        ^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\sql\visitors.py", line 138, in _compiler_dispatch
    return meth(self, **kw)  # type: ignore  # noqa: E501
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\sql\compiler.py", line 5896, in visit_insert
    crud_params_struct = crud._get_crud_params(
        self,
    ...<4 lines>...
        **kw,
    )
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\sql\crud.py", line 381, in _get_crud_params
    raise exc.CompileError(
    ...<2 lines>...
    )
sqlalchemy.exc.CompileError: Unconsumed column names: user_id
2025-12-20 19:02:11,496 - aiogram.dispatcher - INFO - Polling stopped for bot @TG_Bot_5665bot id=8459808785 - 'TG_Bot_5665'
2025-12-20 19:02:11,693 - asyncio - ERROR - Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x00000189E5325D10>
2025-12-20 19:02:16,779 - aiogram.event - INFO - Update id=846056371 is not handled. Duration 113 ms by bot id=8459808785
2025-12-20 19:02:16,779 - aiogram.event - ERROR - Cause exception while process update id=846056371 by bot id=8459808785
DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: 5688458167 (value out of int32 range)
[SQL: SELECT requests.user_id AS requests_user_id, requests.id AS requests_id, requests.category_id AS requests_category_id, requests.text AS requests_text, requests.address AS requests_address, requests.status AS requests_status, requests.created_at AS requests_created_at 
FROM requests 
WHERE requests.user_id IN ($1::INTEGER)]
[parameters: (5688458167,)]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
Traceback (most recent call last):
  File "asyncpg\\protocol\\prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg\\protocol\\codecs/base.pyx", line 227, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg\\protocol\\codecs/base.pyx", line 129, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg\\pgproto\\./codecs/int.pyx", line 60, in asyncpg.pgproto.pgproto.int4_encode
OverflowError: value out of int32 range

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
        lambda protocol: protocol.bind_execute(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            self._state, args, '', limit, True, timeout))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 185, in bind_execute
  File "asyncpg\\protocol\\prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: 5688458167 (value out of int32 range)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self._prepare_and_execute(operation, parameters)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: 5688458167 (value out of int32 range)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\midlewares\logging.py", line 26, in __call__
    response = await handler(event, data)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\midlewares\auth.py", line 25, in __call__
    user = await manager.get_or_create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\manager\user.py", line 55, in get_or_create
    user = await self.create(id,full_name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\manager\user.py", line 17, in create
    result = await self.db.execute(stmt)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 449, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2249, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self,
        ^^^^^
    ...<4 lines>...
        conn,
        ^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\orm\bulk_persistence.py", line 1324, in orm_execute_statement
    return cls._return_orm_returning(
           ~~~~~~~~~~~~~~~~~~~~~~~~~^
        session,
        ^^^^^^^^
    ...<4 lines>...
        result,
        ^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\orm\bulk_persistence.py", line 641, in _return_orm_returning
    return loading.instances(result, querycontext)
           ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\orm\loading.py", line 262, in instances
    _prebuffered = list(chunks(None))
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\orm\loading.py", line 247, in chunks
    post_load.invoke(context, path)
    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\orm\loading.py", line 1564, in invoke
    loader(
    ~~~~~~^
        effective_context, path, states, self.load_keys, *arg, **kw
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\orm\strategies.py", line 3338, in _load_for_path
    self._load_via_parent(
    ~~~~~~~~~~~~~~~~~~~~~^
        our_states, query_info, q, context, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\orm\strategies.py", line 3414, in _load_via_parent
    context.session.execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        q,
        ^^
        params={"primary_keys": primary_keys},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        execution_options=execution_options,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ).unique(),
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2249, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self,
        ^^^^^
    ...<4 lines>...
        conn,
        ^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
        statement, params or {}, execution_options=execution_options
    )
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ~~~~~~~~~~~~~~~~~~~~~~~~~^
        dialect, context, statement, parameters
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e, str_statement, effective_parameters, cursor, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self._prepare_and_execute(operation, parameters)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: 5688458167 (value out of int32 range)
[SQL: SELECT requests.user_id AS requests_user_id, requests.id AS requests_id, requests.category_id AS requests_category_id, requests.text AS requests_text, requests.address AS requests_address, requests.status AS requests_status, requests.created_at AS requests_created_at 
FROM requests 
WHERE requests.user_id IN ($1::INTEGER)]
[parameters: (5688458167,)]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 19:02:57,127 - aiogram.dispatcher - INFO - Polling stopped
2025-12-20 19:02:57,395 - aiogram.dispatcher - INFO - Polling stopped for bot @TG_Bot_5665bot id=8459808785 - 'TG_Bot_5665'
2025-12-20 19:02:57,668 - asyncio - ERROR - Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x0000026F63F5E210>
2025-12-20 19:03:03,040 - aiogram.event - INFO - Update id=846056372 is not handled. Duration 214 ms by bot id=8459808785
2025-12-20 19:03:03,041 - aiogram.event - ERROR - Cause exception while process update id=846056372 by bot id=8459808785
DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: 5688458167 (value out of int32 range)
[SQL: SELECT requests.user_id AS requests_user_id, requests.id AS requests_id, requests.category_id AS requests_category_id, requests.text AS requests_text, requests.address AS requests_address, requests.status AS requests_status, requests.created_at AS requests_created_at 
FROM requests 
WHERE requests.user_id IN ($1::INTEGER)]
[parameters: (5688458167,)]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
Traceback (most recent call last):
  File "asyncpg\\protocol\\prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg\\protocol\\codecs/base.pyx", line 227, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg\\protocol\\codecs/base.pyx", line 129, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg\\pgproto\\./codecs/int.pyx", line 60, in asyncpg.pgproto.pgproto.int4_encode
OverflowError: value out of int32 range

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 550, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
        lambda protocol: protocol.bind_execute(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            self._state, args, '', limit, True, timeout))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 185, in bind_execute
  File "asyncpg\\protocol\\prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $1: 5688458167 (value out of int32 range)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self._prepare_and_execute(operation, parameters)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: 5688458167 (value out of int32 range)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\midlewares\logging.py", line 26, in __call__
    response = await handler(event, data)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\midlewares\auth.py", line 25, in __call__
    user = await manager.get_or_create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\manager\user.py", line 55, in get_or_create
    user = await self.create(user_id,full_name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\manager\user.py", line 17, in create
    result = await self.db.execute(stmt)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 449, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2249, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self,
        ^^^^^
    ...<4 lines>...
        conn,
        ^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\orm\bulk_persistence.py", line 1324, in orm_execute_statement
    return cls._return_orm_returning(
           ~~~~~~~~~~~~~~~~~~~~~~~~~^
        session,
        ^^^^^^^^
    ...<4 lines>...
        result,
        ^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\orm\bulk_persistence.py", line 641, in _return_orm_returning
    return loading.instances(result, querycontext)
           ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\orm\loading.py", line 262, in instances
    _prebuffered = list(chunks(None))
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\orm\loading.py", line 247, in chunks
    post_load.invoke(context, path)
    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\orm\loading.py", line 1564, in invoke
    loader(
    ~~~~~~^
        effective_context, path, states, self.load_keys, *arg, **kw
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\orm\strategies.py", line 3338, in _load_for_path
    self._load_via_parent(
    ~~~~~~~~~~~~~~~~~~~~~^
        our_states, query_info, q, context, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\orm\strategies.py", line 3414, in _load_via_parent
    context.session.execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        q,
        ^^
        params={"primary_keys": primary_keys},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        execution_options=execution_options,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ).unique(),
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2249, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self,
        ^^^^^
    ...<4 lines>...
        conn,
        ^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
        statement, params or {}, execution_options=execution_options
    )
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ~~~~~~~~~~~~~~~~~~~~~~~~~^
        dialect, context, statement, parameters
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e, str_statement, effective_parameters, cursor, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self._prepare_and_execute(operation, parameters)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $1: 5688458167 (value out of int32 range)
[SQL: SELECT requests.user_id AS requests_user_id, requests.id AS requests_id, requests.category_id AS requests_category_id, requests.text AS requests_text, requests.address AS requests_address, requests.status AS requests_status, requests.created_at AS requests_created_at 
FROM requests 
WHERE requests.user_id IN ($1::INTEGER)]
[parameters: (5688458167,)]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-12-20 19:07:55,957 - aiogram.dispatcher - INFO - Polling stopped
2025-12-20 19:07:56,224 - aiogram.dispatcher - INFO - Polling stopped for bot @TG_Bot_5665bot id=8459808785 - 'TG_Bot_5665'
2025-12-20 19:07:56,380 - asyncio - ERROR - Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x000002B4EF18E210>
2025-12-20 19:08:01,872 - bot - INFO - MESSAGE - 537.0900630950928
2025-12-20 19:08:01,872 - aiogram.event - INFO - Update id=846056373 is handled. Duration 538 ms by bot id=8459808785
2025-12-20 19:11:43,601 - aiogram.dispatcher - INFO - Polling stopped
2025-12-20 19:11:43,867 - aiogram.dispatcher - INFO - Polling stopped for bot @TG_Bot_5665bot id=8459808785 - 'TG_Bot_5665'
2025-12-20 19:11:50,660 - bot - INFO - MESSAGE - 548.9318370819092
2025-12-20 19:11:50,661 - aiogram.event - INFO - Update id=846056374 is handled. Duration 550 ms by bot id=8459808785
2025-12-20 19:11:59,590 - bot - INFO - MESSAGE - 142.4400806427002
2025-12-20 19:11:59,590 - aiogram.event - INFO - Update id=846056375 is handled. Duration 143 ms by bot id=8459808785
2025-12-20 19:12:11,090 - bot - INFO - MESSAGE - 155.06291389465332
2025-12-20 19:12:11,090 - aiogram.event - INFO - Update id=846056376 is handled. Duration 155 ms by bot id=8459808785
2025-12-20 19:12:17,931 - bot - INFO - MESSAGE - 132.28845596313477
2025-12-20 19:12:17,931 - aiogram.event - INFO - Update id=846056377 is handled. Duration 132 ms by bot id=8459808785
2025-12-20 19:12:21,282 - bot - INFO - MESSAGE - 136.17181777954102
2025-12-20 19:12:21,283 - aiogram.event - INFO - Update id=846056378 is handled. Duration 136 ms by bot id=8459808785
2025-12-20 19:17:24,283 - aiogram.dispatcher - INFO - Polling stopped
2025-12-20 19:17:24,541 - aiogram.dispatcher - INFO - Polling stopped for bot @TG_Bot_5665bot id=8459808785 - 'TG_Bot_5665'
2025-12-20 20:19:07,724 - bot - INFO - MESSAGE - 643.0516242980957
2025-12-20 20:19:07,724 - aiogram.event - INFO - Update id=846056379 is handled. Duration 645 ms by bot id=8459808785
2025-12-20 20:19:46,071 - bot - INFO - MESSAGE - 212.571382522583
2025-12-20 20:19:46,071 - aiogram.event - INFO - Update id=846056380 is handled. Duration 213 ms by bot id=8459808785
2025-12-20 20:20:07,128 - aiogram.dispatcher - INFO - Polling stopped
2025-12-20 20:20:07,391 - aiogram.dispatcher - INFO - Polling stopped for bot @TG_Bot_5665bot id=8459808785 - 'TG_Bot_5665'
2025-12-20 20:20:13,502 - bot - INFO - MESSAGE - 700.5329132080078
2025-12-20 20:20:13,503 - aiogram.event - INFO - Update id=846056381 is handled. Duration 702 ms by bot id=8459808785
2025-12-20 20:20:39,432 - bot - INFO - MESSAGE - 253.4797191619873
2025-12-20 20:20:39,432 - aiogram.event - INFO - Update id=846056382 is handled. Duration 254 ms by bot id=8459808785
2025-12-20 20:26:20,629 - aiogram.dispatcher - INFO - Polling stopped
2025-12-20 20:26:20,630 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected
2025-12-20 20:26:20,630 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8459808785)
2025-12-20 20:26:20,935 - aiogram.dispatcher - INFO - Polling stopped for bot @TG_Bot_5665bot id=8459808785 - 'TG_Bot_5665'
2025-12-20 20:26:42,917 - bot - INFO - MESSAGE - 715.5191898345947
2025-12-20 20:26:42,918 - aiogram.event - INFO - Update id=846056384 is handled. Duration 716 ms by bot id=8459808785
2025-12-20 20:26:42,998 - bot - INFO - MESSAGE - 798.7565994262695
2025-12-20 20:26:42,998 - aiogram.event - INFO - Update id=846056383 is handled. Duration 800 ms by bot id=8459808785
2025-12-20 20:49:09,928 - aiogram.dispatcher - INFO - Polling stopped
2025-12-20 20:49:10,184 - aiogram.dispatcher - INFO - Polling stopped for bot @TG_Bot_5665bot id=8459808785 - 'TG_Bot_5665'
2025-12-20 20:49:18,661 - bot - INFO - MESSAGE - 1417.281150817871
2025-12-20 20:49:18,661 - aiogram.event - INFO - Update id=846056385 is handled. Duration 1420 ms by bot id=8459808785
2025-12-20 20:49:22,179 - bot - INFO - Callback - 623.3417987823486
2025-12-20 20:49:22,179 - aiogram.event - INFO - Update id=846056386 is handled. Duration 624 ms by bot id=8459808785
2025-12-20 20:49:35,278 - bot - INFO - MESSAGE - 194.9319839477539
2025-12-20 20:49:35,278 - aiogram.event - INFO - Update id=846056387 is handled. Duration 195 ms by bot id=8459808785
2025-12-20 20:51:47,278 - aiogram.dispatcher - INFO - Polling stopped
2025-12-20 20:51:47,532 - aiogram.dispatcher - INFO - Polling stopped for bot @TG_Bot_5665bot id=8459808785 - 'TG_Bot_5665'
2025-12-20 20:51:54,082 - bot - INFO - MESSAGE - 580.878734588623
2025-12-20 20:51:54,083 - aiogram.event - INFO - Update id=846056388 is handled. Duration 582 ms by bot id=8459808785
2025-12-20 20:51:56,270 - bot - INFO - Callback - 196.31338119506836
2025-12-20 20:51:56,270 - aiogram.event - INFO - Update id=846056389 is handled. Duration 197 ms by bot id=8459808785
2025-12-20 20:52:03,924 - bot - INFO - MESSAGE - 234.52115058898926
2025-12-20 20:52:03,924 - aiogram.event - INFO - Update id=846056390 is handled. Duration 235 ms by bot id=8459808785
2025-12-20 20:52:49,598 - aiogram.dispatcher - INFO - Polling stopped
2025-12-20 20:52:49,867 - aiogram.dispatcher - INFO - Polling stopped for bot @TG_Bot_5665bot id=8459808785 - 'TG_Bot_5665'
2025-12-20 20:52:49,868 - aiogram.event - INFO - Update id=846056391 is not handled. Duration 267 ms by bot id=8459808785
2025-12-20 20:52:56,211 - bot - INFO - MESSAGE - 590.7397270202637
2025-12-20 20:52:56,211 - aiogram.event - INFO - Update id=846056391 is handled. Duration 593 ms by bot id=8459808785
2025-12-20 20:52:58,379 - bot - INFO - Callback - 186.9945526123047
2025-12-20 20:52:58,379 - aiogram.event - INFO - Update id=846056392 is handled. Duration 188 ms by bot id=8459808785
2025-12-20 20:53:02,642 - bot - INFO - MESSAGE - 299.6785640716553
2025-12-20 20:53:02,642 - aiogram.event - INFO - Update id=846056393 is handled. Duration 300 ms by bot id=8459808785
2025-12-20 20:54:55,559 - aiogram.dispatcher - INFO - Polling stopped
2025-12-20 20:54:55,824 - aiogram.dispatcher - INFO - Polling stopped for bot @TG_Bot_5665bot id=8459808785 - 'TG_Bot_5665'
2025-12-20 20:55:03,182 - bot - INFO - MESSAGE - 1187.7820491790771
2025-12-20 20:55:03,182 - aiogram.event - INFO - Update id=846056394 is handled. Duration 1189 ms by bot id=8459808785
2025-12-20 20:55:06,388 - bot - INFO - Callback - 197.0052719116211
2025-12-20 20:55:06,388 - aiogram.event - INFO - Update id=846056395 is handled. Duration 197 ms by bot id=8459808785
2025-12-20 20:55:07,607 - bot - INFO - MESSAGE - 204.91290092468262
2025-12-20 20:55:07,608 - aiogram.event - INFO - Update id=846056396 is handled. Duration 205 ms by bot id=8459808785
2025-12-20 20:55:12,342 - aiogram.event - INFO - Update id=846056397 is not handled. Duration 4 ms by bot id=8459808785
2025-12-20 20:55:12,342 - aiogram.event - ERROR - Cause exception while process update id=846056397 by bot id=8459808785
AttributeError: 'Message' object has no attribute 'message'
Traceback (most recent call last):
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\midlewares\logging.py", line 26, in __call__
    response = await handler(event, data)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\midlewares\auth.py", line 30, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        observer=observer, update_type=update_type, event=telegram_event, **data
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        observer=observer, update_type=update_type, event=telegram_event, **data
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\routes\user.py", line 36, in process_geo
    address = cb.message.text
              ^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\pydantic\main.py", line 991, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'Message' object has no attribute 'message'. Did you mean: 'message_id'?
2025-12-20 20:56:03,118 - aiogram.dispatcher - INFO - Polling stopped
2025-12-20 20:56:03,381 - aiogram.dispatcher - INFO - Polling stopped for bot @TG_Bot_5665bot id=8459808785 - 'TG_Bot_5665'
2025-12-20 20:56:12,231 - bot - INFO - MESSAGE - 579.8535346984863
2025-12-20 20:56:12,231 - aiogram.event - INFO - Update id=846056398 is handled. Duration 581 ms by bot id=8459808785
2025-12-20 20:56:14,907 - bot - INFO - Callback - 217.78440475463867
2025-12-20 20:56:14,908 - aiogram.event - INFO - Update id=846056399 is handled. Duration 218 ms by bot id=8459808785
2025-12-20 20:56:19,281 - bot - INFO - MESSAGE - 172.5749969482422
2025-12-20 20:56:19,281 - aiogram.event - INFO - Update id=846056400 is handled. Duration 173 ms by bot id=8459808785
2025-12-20 20:56:22,045 - aiogram.event - INFO - Update id=846056401 is not handled. Duration 100 ms by bot id=8459808785
2025-12-20 20:56:22,045 - aiogram.event - ERROR - Cause exception while process update id=846056401 by bot id=8459808785
ValidationError: 1 validation error for InlineKeyboardButton
text
  Input should be a valid string [type=string_type, input_value=<models.category.Category...t at 0x000002251C1442F0>, input_type=Category]
    For further information visit https://errors.pydantic.dev/2.11/v/string_type
Traceback (most recent call last):
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\midlewares\logging.py", line 26, in __call__
    response = await handler(event, data)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\midlewares\auth.py", line 30, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        observer=observer, update_type=update_type, event=telegram_event, **data
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        observer=observer, update_type=update_type, event=telegram_event, **data
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\routes\user.py", line 43, in process_geo
    await message.answer("¬ыберите категорию", reply_markup=get_category_kb(categories_list))
                                                            ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\keyboards\user.py", line 8, in get_category_kb
    builder.button(text=category, callback_data=f"cat_{category}")
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\utils\keyboard.py", line 323, in button
    self._button(
    ~~~~~~~~~~~~^
        text=text,
        ^^^^^^^^^^
    ...<10 lines>...
        **kwargs,
        ^^^^^^^^^
    ),
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\utils\keyboard.py", line 256, in _button
    button = self._button_type(**kwargs)
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\pydantic\main.py", line 253, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
pydantic_core._pydantic_core.ValidationError: 1 validation error for InlineKeyboardButton
text
  Input should be a valid string [type=string_type, input_value=<models.category.Category...t at 0x000002251C1442F0>, input_type=Category]
    For further information visit https://errors.pydantic.dev/2.11/v/string_type
2025-12-20 20:57:41,733 - bot - INFO - MESSAGE - 192.5070285797119
2025-12-20 20:57:41,733 - aiogram.event - INFO - Update id=846056402 is handled. Duration 193 ms by bot id=8459808785
2025-12-20 20:57:47,026 - bot - INFO - Callback - 222.761869430542
2025-12-20 20:57:47,027 - aiogram.event - INFO - Update id=846056403 is handled. Duration 223 ms by bot id=8459808785
2025-12-20 20:57:53,067 - bot - INFO - MESSAGE - 179.75974082946777
2025-12-20 20:57:53,067 - aiogram.event - INFO - Update id=846056404 is handled. Duration 180 ms by bot id=8459808785
2025-12-20 20:57:55,492 - aiogram.event - INFO - Update id=846056405 is not handled. Duration 7 ms by bot id=8459808785
2025-12-20 20:57:55,492 - aiogram.event - ERROR - Cause exception while process update id=846056405 by bot id=8459808785
ValidationError: 1 validation error for InlineKeyboardButton
text
  Input should be a valid string [type=string_type, input_value=<models.category.Category...t at 0x000002251C1FAE50>, input_type=Category]
    For further information visit https://errors.pydantic.dev/2.11/v/string_type
Traceback (most recent call last):
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\midlewares\logging.py", line 26, in __call__
    response = await handler(event, data)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\midlewares\auth.py", line 30, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        observer=observer, update_type=update_type, event=telegram_event, **data
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        observer=observer, update_type=update_type, event=telegram_event, **data
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\routes\user.py", line 43, in process_geo
    await message.answer("¬ыберите категорию", reply_markup=get_category_kb(categories_list))
                                                            ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\keyboards\user.py", line 8, in get_category_kb
    print(category)
    ~~~~~^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\utils\keyboard.py", line 323, in button
    self._button(
    ~~~~~~~~~~~~^
        text=text,
        ^^^^^^^^^^
    ...<10 lines>...
        **kwargs,
        ^^^^^^^^^
    ),
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\utils\keyboard.py", line 256, in _button
    button = self._button_type(**kwargs)
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\pydantic\main.py", line 253, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
pydantic_core._pydantic_core.ValidationError: 1 validation error for InlineKeyboardButton
text
  Input should be a valid string [type=string_type, input_value=<models.category.Category...t at 0x000002251C1FAE50>, input_type=Category]
    For further information visit https://errors.pydantic.dev/2.11/v/string_type
2025-12-20 20:59:26,921 - aiogram.dispatcher - INFO - Polling stopped
2025-12-20 20:59:27,184 - aiogram.dispatcher - INFO - Polling stopped for bot @TG_Bot_5665bot id=8459808785 - 'TG_Bot_5665'
2025-12-20 20:59:41,941 - bot - INFO - MESSAGE - 667.3829555511475
2025-12-20 20:59:41,942 - aiogram.event - INFO - Update id=846056406 is handled. Duration 669 ms by bot id=8459808785
2025-12-20 20:59:43,464 - bot - INFO - Callback - 174.835205078125
2025-12-20 20:59:43,464 - aiogram.event - INFO - Update id=846056407 is handled. Duration 175 ms by bot id=8459808785
2025-12-20 20:59:48,581 - bot - INFO - MESSAGE - 257.2598457336426
2025-12-20 20:59:48,581 - aiogram.event - INFO - Update id=846056408 is handled. Duration 258 ms by bot id=8459808785
2025-12-20 20:59:51,111 - bot - INFO - MESSAGE - 306.049108505249
2025-12-20 20:59:51,112 - aiogram.event - INFO - Update id=846056409 is handled. Duration 306 ms by bot id=8459808785
2025-12-20 20:59:54,192 - aiogram.event - INFO - Update id=846056410 is not handled. Duration 8 ms by bot id=8459808785
2025-12-20 20:59:54,192 - aiogram.event - ERROR - Cause exception while process update id=846056410 by bot id=8459808785
TypeError: RequestManager.create() missing 1 required positional argument: 'self'
Traceback (most recent call last):
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\midlewares\logging.py", line 26, in __call__
    response = await handler(event, data)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\midlewares\auth.py", line 30, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        observer=observer, update_type=update_type, event=telegram_event, **data
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        observer=observer, update_type=update_type, event=telegram_event, **data
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\routes\user.py", line 54, in process_category
    await req.create(
          ~~~~~~~~~~^
        user_id=user.id,
        ^^^^^^^^^^^^^^^^
    ...<2 lines>...
        address=data['address']
        ^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
TypeError: RequestManager.create() missing 1 required positional argument: 'self'
2025-12-20 20:59:56,072 - aiogram.event - INFO - Update id=846056411 is not handled. Duration 5 ms by bot id=8459808785
2025-12-20 20:59:56,072 - aiogram.event - ERROR - Cause exception while process update id=846056411 by bot id=8459808785
TypeError: RequestManager.create() missing 1 required positional argument: 'self'
Traceback (most recent call last):
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\midlewares\logging.py", line 26, in __call__
    response = await handler(event, data)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\midlewares\auth.py", line 30, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        observer=observer, update_type=update_type, event=telegram_event, **data
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        observer=observer, update_type=update_type, event=telegram_event, **data
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\routes\user.py", line 54, in process_category
    await req.create(
          ~~~~~~~~~~^
        user_id=user.id,
        ^^^^^^^^^^^^^^^^
    ...<2 lines>...
        address=data['address']
        ^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
TypeError: RequestManager.create() missing 1 required positional argument: 'self'
2025-12-20 21:03:59,801 - aiogram.dispatcher - INFO - Polling stopped
2025-12-20 21:04:00,059 - aiogram.dispatcher - INFO - Polling stopped for bot @TG_Bot_5665bot id=8459808785 - 'TG_Bot_5665'
2025-12-20 21:04:07,621 - bot - INFO - MESSAGE - 625.645637512207
2025-12-20 21:04:07,621 - aiogram.event - INFO - Update id=846056412 is handled. Duration 627 ms by bot id=8459808785
2025-12-20 21:04:09,097 - bot - INFO - Callback - 242.8267002105713
2025-12-20 21:04:09,097 - aiogram.event - INFO - Update id=846056413 is handled. Duration 243 ms by bot id=8459808785
2025-12-20 21:04:13,323 - bot - INFO - MESSAGE - 177.83713340759277
2025-12-20 21:04:13,323 - aiogram.event - INFO - Update id=846056414 is handled. Duration 178 ms by bot id=8459808785
2025-12-20 21:04:15,737 - bot - INFO - MESSAGE - 400.09140968322754
2025-12-20 21:04:15,737 - aiogram.event - INFO - Update id=846056415 is handled. Duration 401 ms by bot id=8459808785
2025-12-20 21:04:19,825 - bot - INFO - Callback - 450.2429962158203
2025-12-20 21:04:19,825 - aiogram.event - INFO - Update id=846056416 is handled. Duration 451 ms by bot id=8459808785
2025-12-20 21:04:22,791 - bot - INFO - Callback - 9.778499603271484
2025-12-20 21:04:22,791 - aiogram.event - INFO - Update id=846056417 is not handled. Duration 10 ms by bot id=8459808785
2025-12-20 21:07:06,569 - aiogram.dispatcher - INFO - Polling stopped
2025-12-20 21:07:06,835 - aiogram.dispatcher - INFO - Polling stopped for bot @TG_Bot_5665bot id=8459808785 - 'TG_Bot_5665'
2025-12-20 21:07:12,993 - bot - INFO - Callback - 133.4395408630371
2025-12-20 21:07:12,994 - aiogram.event - INFO - Update id=846056418 is handled. Duration 136 ms by bot id=8459808785
2025-12-20 21:08:56,846 - aiogram.dispatcher - INFO - Polling stopped
2025-12-20 21:08:57,113 - aiogram.dispatcher - INFO - Polling stopped for bot @TG_Bot_5665bot id=8459808785 - 'TG_Bot_5665'
2025-12-20 21:09:06,415 - bot - INFO - Callback - 139.04881477355957
2025-12-20 21:09:06,415 - aiogram.event - INFO - Update id=846056419 is handled. Duration 141 ms by bot id=8459808785
2025-12-20 21:10:04,637 - aiogram.dispatcher - INFO - Polling stopped
2025-12-20 21:10:04,638 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected
2025-12-20 21:10:04,638 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8459808785)
2025-12-20 21:10:04,903 - aiogram.dispatcher - INFO - Polling stopped for bot @TG_Bot_5665bot id=8459808785 - 'TG_Bot_5665'
2025-12-20 21:10:16,104 - bot - INFO - Callback - 234.30824279785156
2025-12-20 21:10:16,104 - aiogram.event - INFO - Update id=846056420 is handled. Duration 236 ms by bot id=8459808785
2025-12-20 21:11:55,861 - aiogram.dispatcher - INFO - Polling stopped
2025-12-20 21:11:56,125 - aiogram.dispatcher - INFO - Polling stopped for bot @TG_Bot_5665bot id=8459808785 - 'TG_Bot_5665'
2025-12-20 21:12:02,477 - bot - INFO - Callback - 241.77885055541992
2025-12-20 21:12:02,477 - aiogram.event - INFO - Update id=846056421 is handled. Duration 244 ms by bot id=8459808785
2025-12-20 21:12:32,647 - aiogram.dispatcher - INFO - Polling stopped
2025-12-20 21:12:32,906 - aiogram.dispatcher - INFO - Polling stopped for bot @TG_Bot_5665bot id=8459808785 - 'TG_Bot_5665'
2025-12-20 21:12:39,929 - bot - INFO - Callback - 714.8306369781494
2025-12-20 21:12:39,929 - aiogram.event - INFO - Update id=846056422 is handled. Duration 717 ms by bot id=8459808785
2025-12-20 21:13:40,205 - aiogram.dispatcher - INFO - Polling stopped
2025-12-20 21:13:40,470 - aiogram.dispatcher - INFO - Polling stopped for bot @TG_Bot_5665bot id=8459808785 - 'TG_Bot_5665'
2025-12-20 21:13:46,274 - aiogram.event - INFO - Update id=846056423 is not handled. Duration 238 ms by bot id=8459808785
2025-12-20 21:13:46,274 - aiogram.event - ERROR - Cause exception while process update id=846056423 by bot id=8459808785
TypeError: can only concatenate str (not "datetime.datetime") to str
Traceback (most recent call last):
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\midlewares\logging.py", line 26, in __call__
    response = await handler(event, data)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\midlewares\auth.py", line 30, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        observer=observer, update_type=update_type, event=telegram_event, **data
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        observer=observer, update_type=update_type, event=telegram_event, **data
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\routes\user.py", line 76, in my_req
    text += det.text+ det.status +det.created_at+ "\n"
            ~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~
TypeError: can only concatenate str (not "datetime.datetime") to str
2025-12-20 21:14:03,551 - aiogram.event - INFO - Update id=846056424 is not handled. Duration 13 ms by bot id=8459808785
2025-12-20 21:14:03,551 - aiogram.event - ERROR - Cause exception while process update id=846056424 by bot id=8459808785
TypeError: can only concatenate str (not "datetime.datetime") to str
Traceback (most recent call last):
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\midlewares\logging.py", line 26, in __call__
    response = await handler(event, data)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\midlewares\auth.py", line 30, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        observer=observer, update_type=update_type, event=telegram_event, **data
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        observer=observer, update_type=update_type, event=telegram_event, **data
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\routes\user.py", line 76, in my_req
    text += det.text+ det.status +det.created_at+ "\n"
            ~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~
TypeError: can only concatenate str (not "datetime.datetime") to str
2025-12-20 21:14:39,635 - aiogram.dispatcher - INFO - Polling stopped
2025-12-20 21:14:39,636 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected
2025-12-20 21:14:39,636 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8459808785)
2025-12-20 21:14:39,900 - aiogram.dispatcher - INFO - Polling stopped for bot @TG_Bot_5665bot id=8459808785 - 'TG_Bot_5665'
2025-12-20 21:14:46,322 - aiogram.event - INFO - Update id=846056425 is not handled. Duration 228 ms by bot id=8459808785
2025-12-20 21:14:46,323 - aiogram.event - ERROR - Cause exception while process update id=846056425 by bot id=8459808785
TypeError: can only concatenate str (not "datetime.datetime") to str
Traceback (most recent call last):
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 309, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 158, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 25, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 56, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\fsm\middleware.py", line 42, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\midlewares\logging.py", line 26, in __call__
    response = await handler(event, data)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\midlewares\auth.py", line 30, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        observer=observer, update_type=update_type, event=telegram_event, **data
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\router.py", line 174, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\router.py", line 146, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\router.py", line 141, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        observer=observer, update_type=update_type, event=telegram_event, **data
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\router.py", line 166, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 121, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 43, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\ANUBIS PC\Desktop\Telegram\CityHelp_bot\routes\user.py", line 76, in my_req
    text += det.text + det.status + det.created_at+ "\n"
            ~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~
TypeError: can only concatenate str (not "datetime.datetime") to str
2025-12-20 21:16:02,630 - aiogram.dispatcher - INFO - Polling stopped
2025-12-20 21:16:02,631 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected
2025-12-20 21:16:02,631 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8459808785)
2025-12-20 21:16:02,882 - aiogram.dispatcher - INFO - Polling stopped for bot @TG_Bot_5665bot id=8459808785 - 'TG_Bot_5665'
2025-12-20 21:16:10,572 - bot - INFO - Callback - 598.0613231658936
2025-12-20 21:16:10,572 - aiogram.event - INFO - Update id=846056426 is handled. Duration 600 ms by bot id=8459808785
2025-12-20 21:16:15,283 - bot - INFO - Callback - 502.4392604827881
2025-12-20 21:16:15,284 - aiogram.event - INFO - Update id=846056427 is handled. Duration 503 ms by bot id=8459808785
2025-12-20 21:25:13,527 - aiogram.dispatcher - INFO - Polling stopped
2025-12-20 21:25:13,789 - aiogram.dispatcher - INFO - Polling stopped for bot @TG_Bot_5665bot id=8459808785 - 'TG_Bot_5665'
